<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="close()">
        <ion-icon
          slot="icon-only"
          name="arrow-back-outline"
          color="primary"
        ></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Add Scaffold </ion-title>
  </ion-toolbar>
</ion-header>
<ion-content class="ion-padding">
  <form [formGroup]="form" (ngSubmit)="createScaffold()" *ngIf="company">
    <ion-grid>
      <!-- SCAFFOLDS -->
      <ion-row class="card-outline mb-3">
        <ion-col size="12">
          <ion-text color="medium">
            <h4>{{ company.terminology.scaffold }} Details</h4>
          </ion-text>
        </ion-col>

        <ion-col size="6">
          <app-input-date
            [form]="form"
            controlName="startDate"
            title="Start Date"
          ></app-input-date>
        </ion-col>
        <ion-col size="6">
          <app-input-date
            [form]="form"
            controlName="endDate"
            [min]="field('startDate').value"
            title="End Date"
          ></app-input-date>
        </ion-col>
        <ion-col size="12">
          <ion-row formGroupName="scaffold">
            <ion-col size="12" sizeMd="6">
              <app-input-reactive
                title="Description"
                controlName="description"
                placeholder="Enter description"
                [form]="field('scaffold')"
              >
              </app-input-reactive>
            </ion-col>
            <ion-col size="12" sizeMd="6">
              <app-input-reactive
                title="Location"
                [optional]="true"
                controlName="location"
                placeholder="Enter scaffold location"
                [form]="field('scaffold')"
              >
              </app-input-reactive>
            </ion-col>

            <ion-col>
              <app-input-select-reactive
                title="Scaffold Type"
                placeholder="Select Type"
                controlName="type"
                [form]="field('scaffold')"
                [selectedText]="field('scaffold.type').value"
              >
                <ng-container *ngIf="types$ | async as types">
                  <ion-select-option
                    [value]="type"
                    *ngFor="let type of types.types"
                    >{{ type }}
                  </ion-select-option>
                </ng-container>
              </app-input-select-reactive>
            </ion-col>
            <ion-col>
              <app-input-reactive
                title="Length ({{ company.measurement.symbol }})"
                type="number"
                controlName="length"
                [form]="field('scaffold')"
                placeholder="L"
              >
              </app-input-reactive>
            </ion-col>
            <ion-col>
              <app-input-reactive
                title="Width ({{ company.measurement.symbol }})"
                type="number"
                controlName="width"
                [form]="field('scaffold')"
                placeholder="W"
              >
              </app-input-reactive>
            </ion-col>
            <ion-col>
              <app-input-reactive
                title="Height ({{ company.measurement.symbol }})"
                type="number"
                controlName="height"
                [form]="field('scaffold')"
                placeholder="H"
              >
              </app-input-reactive>
            </ion-col>
            <!-- <ion-col>
              <app-input-reactive
                title="Lifts"
                type="number"
                controlName="lifts"
                [form]="field('scaffold')"
                placeholder="No. Lifts"
              >
              </app-input-reactive>
            </ion-col>
            <ion-col>
              <app-input-reactive
                title="Boarded Lifts"
                type="number"
                controlName="boardedLifts"
                [form]="field('scaffold')"
                placeholder="No. Boarded Lifts"
              >
              </app-input-reactive>
            </ion-col> -->
          </ion-row>
          <ion-row
            formArrayName="attachments"
            class="mb-3"
            *ngFor="let attachment of attachmentsForms.controls; let i = index"
          >
            <ion-col size="12">
              <hr />
              <ion-note> Attachment {{ i + 1 }} </ion-note>
              <ion-chip
                outline
                color="danger"
                class="ion-float-end"
                (click)="deleteAttachment(i)"
              >
                <ion-label>Delete</ion-label>
              </ion-chip>
            </ion-col>

            <ion-col size="12" sizeMd="6">
              <app-input-reactive
                title="Description"
                controlName="description"
                placeholder="Enter description"
                [form]="attachment"
              >
              </app-input-reactive>
            </ion-col>
            <ion-col size="12" sizeMd="6">
              <app-input-reactive
                title="Location"
                [optional]="true"
                controlName="location"
                placeholder="Enter attachment location"
                [form]="attachment"
              >
              </app-input-reactive>
            </ion-col>
            <ion-col>
              <app-input-select-reactive
                title="Scaffold Type"
                placeholder="Select Type"
                controlName="type"
                [form]="attachment"
                [selectedText]="arrField('attachments', i, 'type').value"
              >
                <ng-container *ngIf="types$ | async as types">
                  <ion-select-option
                    [value]="type"
                    *ngFor="let type of types.types"
                    >{{ type }}
                  </ion-select-option>
                </ng-container>
              </app-input-select-reactive>
            </ion-col>
            <ion-col>
              <app-input-reactive
                title="Length ({{ company.measurement.symbol }})"
                type="number"
                controlName="length"
                placeholder="L"
                [form]="attachment"
              >
              </app-input-reactive>
            </ion-col>
            <ion-col>
              <app-input-reactive
                title="Width ({{ company.measurement.symbol }})"
                type="number"
                controlName="width"
                placeholder="W"
                [form]="attachment"
              >
              </app-input-reactive>
            </ion-col>
            <ion-col>
              <app-input-reactive
                title="Height ({{ company.measurement.symbol }})"
                type="number"
                controlName="height"
                placeholder="H"
                [form]="attachment"
              >
              </app-input-reactive>
            </ion-col>
            <!-- <ion-col>
              <app-input-reactive
                title="Lifts"
                type="number"
                controlName="lifts"
                placeholder="No. of Lifts"
                [form]="attachment"
              >
              </app-input-reactive>
            </ion-col>
            <ion-col>
              <app-input-reactive
                title="Boarded Lifts"
                type="number"
                controlName="boardedLifts"
                [form]="attachment"
                placeholder="No. Boarded Lifts"
              >
              </app-input-reactive>
            </ion-col> -->
            <ion-col>
              <app-input-reactive
                title="Level"
                [optional]="true"
                type="number"
                controlName="level"
                placeholder="1"
                [form]="attachment"
              >
              </app-input-reactive>
            </ion-col>
          </ion-row>
          <ion-row class="mb-3">
            <ion-col>
              <ion-fab-button
                size="small"
                class="m-auto"
                color="success"
                (click)="addAttachment()"
              >
                <ion-icon name="add"></ion-icon>
              </ion-fab-button>
            </ion-col>
          </ion-row>
        </ion-col>
      </ion-row>
      <!-- BOARDS -->
      <ion-row class="px-3">
        <ion-col size="12">
          <ion-text color="medium">
            <h4>{{ company.terminology.boards }} Details</h4>
          </ion-text>
        </ion-col>
      </ion-row>
      <ion-row
        formArrayName="boards"
        class="card-outline mb-3"
        *ngFor="let board of boardForms.controls; let i = index"
      >
        <ion-col size="12">
          <ion-note> Item {{ i + 1 }} </ion-note>
          <ion-chip
            outline
            color="danger"
            class="ion-float-end"
            (click)="deleteBoard(i)"
          >
            <ion-label>Delete</ion-label>
          </ion-chip>
        </ion-col>
        <ion-col>
          <app-input-reactive
            title="Length ({{ company.measurement.symbol }})"
            type="number"
            controlName="length"
            placeholder="L"
            [form]="board"
          >
          </app-input-reactive>
        </ion-col>
        <ion-col>
          <app-input-reactive
            title="Width ({{ company.measurement.symbol }})"
            type="number"
            controlName="width"
            placeholder="W"
            [form]="board"
          >
          </app-input-reactive>
        </ion-col>
        <ion-col>
          <app-input-reactive
            title="Level ({{ company.measurement.symbol }})"
            type="number"
            controlName="height"
            placeholder="H"
            [form]="board"
          >
          </app-input-reactive>
        </ion-col>
        <ion-col>
          <app-input-reactive
            title="Qty"
            type="number"
            controlName="qty"
            placeholder="Enter Qty"
            [form]="board"
          >
          </app-input-reactive>
        </ion-col>
      </ion-row>
      <ion-row class="mb-3">
        <ion-col>
          <ion-fab-button
            size="small"
            class="m-auto"
            color="success"
            (click)="addBoard()"
          >
            <ion-icon name="add"></ion-icon>
          </ion-fab-button>
        </ion-col>
      </ion-row>
    </ion-grid>
    <div class="text-end">
      <ion-progress-bar
        type="indeterminate"
        *ngIf="isLoading"
      ></ion-progress-bar>
      <ion-button
        *ngIf="!isLoading"
        color="success"
        shape="round"
        type="submit"
      >
        Create Scaffold
      </ion-button>
    </div>
  </form>
</ion-content>
